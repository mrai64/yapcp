# Diario dello sviluppatore, data 14 ottobre 2025

* [index](../index.md)

* [TDL](../TDL.md)
* [project](https://github.com/users/mrai64/projects/1)
* [◀️ ieri](./2025-10-13_IT.md)
* [log](/storage/logs/laravel.log)

## Relazioni tra tabelle

Posto che farlo quando si creano le tabelle
è *per definizione* più semplice, creare una
relazione tra tabelle quando sono caricate
comporta l'uso di una tabella di travaso, in cui
caricare i dati, la cancellazione (ammesso che
ci si riesca) e ricreazione della tabella
correlata, il travaso di ritorno dei dati. Per
ora si fa niente, ma intanto la relazione
(manualmente, in phpMyAdmin) l'ho creata.
Intanto le funzioni di connessione hasOne e
belongsTo le ho inserite nei Models.

## Cose da fare

### feat: User Roles: Juror *end-of-role date* must be *contest.end-of-jury+1day* id:2025-09-28.06 #7

* La tabella user_roles contiene record juror che hanno
  * lo stesso user
  * lo stesso ruolo juror
  * lo stesso organization_id NULL
  * lo stesso federation_id NULL
  * lo stesso contest_id
  * data role opening differente per orario

Deve essere modificata la creazione del record
per usare come role_opening una data con orario
00:00:00, e se il record risulta già presente
non deve creare errore. Si deve tenere in linea
il dato del contest che nel calendario ha il campo
day_4_jury_closing. La data di fine mandato deve essere
quella data con orario 23:59:59.

Si può usare un metodo ~~insertOrUpdate()~~ sì, ma si chiama updateOrCreate().

#### orario contest: jury_opening con orario 00:00:00 jury_closing con orario 23:59:59

La modifica che assegna gli orari ha funzionato, e
comunque vengono inseriti i record doppi.
Decido di passare al modo vecchio, se il conteggio
dei record da  zero inserisco altrimenti tiro dritto.

Funziona **commit**
