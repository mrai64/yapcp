# Diario dello sviluppatore, data 11 ottobre 2025

* [index](../index.md)
* [TDL](../TDL.md)
* [project](https://github.com/users/mrai64/projects/1)
* [◀️ ieri](./2025-10-10_IT.md)
* [log](/storage/logs/laravel.log)

## Prossimo step

### Lista dei partecipanti (2)

Segue da [ieri](./2025-10-10_IT.md#lista-dei-partecipanti-2)

#### Middleware per le abilitazioni

L'utente deve essere:

* registrato
* verificato
* presente nella tabella user_roles
  con legame al concorso

Nella documentazione di laravel si parla di
[Gates](https://laravel.com/docs/12.x/authorization#gates) e di
[Policies](https://laravel.com/docs/12.x/authorization#creating-policies).
Gates ha molte traduzioni, si può tradurre con tornelli.
Policies invece ha una traduzione meno varia, Politica, ma politica ha
molte accezioni. Se i tornelli sono una versione base delle autorizzazioni
le politiche si applicano tramite delle classi, quindi possono
avere metodi - funzioni piuttosto articolati.  
[RACF](https://en.wikipedia.org/wiki/Resource_Access_Control_Facility) 
in mainframe è stato uno dei primi *gestori di accesso*
che ho incontrato, mentre in seguito all'interno delle applicazioni c'erano
livelli di abilitazione per singoli utenti e per gruppi a cui appartiene
l'utente, la cosa era monitorata da un ufficio dedicato.

Per un concorso quindi dedicare un Gates o una Policy? Dovendo fare
verifiche basate su accessi a tabelle, sarà il caso di creare delle Policy.
Ma prima guardo ai Gates, magari anche questi sono usabili.
Si parte sempre da `Auth::id()`.

```php
$ php artisan make:policy ContestPaymentChangePolicy

   INFO  Policy [app/Policies/ContestPaymentChangePolicy.php] created successfully.  

```

Questa classe verifica se user_id è abilitato a modificare il campo
`fee_payment_completed` nella tabella `contest_participants`perché
fa parte delle persone legate al `contest_id` nella tabella `user_roles`
con role `chairman`. Oppure ai membri di `organization_id` che ha
inserito e gestisce il contest. Per i circuiti si farà rifermento al
record del circuito con is_circuit === 'Y'.
Anche il concorrente può modificare il suo status di pagamento,
aggiungendo in futuro un allegato pdg o jpg la ricevuta di pagamento. (creare un issue dedicato)
