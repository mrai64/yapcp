# Diario dello sviluppatore, data 19 settembre 2025

Nav: [index](../index.md) : [TDL](../TDL.md) : [log](../../storage/logs/laravel.log)

## Gestione degli orari time_zone timezone segue

Regole dal gruppo Laravel Italia

* Usare sempre in db solo orari UTC , se il mysql è configurato ok, quando registro un orario del fuso di Roma + ora legale devo vedere 2 ore di differenza con il dato memorizzato in archivio, ed è giusto così.
* Tenere conto che ogni tanto esiste il 23:59:60 a fine anno per regolare gli orologi
* regolare l'orologio sul timezone solo per esposizione dato. prevedere i campi con il fuso orario -12:00 +12:00 (sono altri 6 caratteri)
* Non si possono impostare funzioni per calcolare il default() per un campo datetime

Mysql e altri dbms nel campo *datetime* registrano quello che arriva ed espongono quello che arriva, senza fare calcoli e conversioni di timezone  

`SELECT @@GLOBAL.time_zone, @@SESSION.time_zone;`  
In mysql la risposta è: SYSTEM, SYSTEM. Significa che viene applicato il fuso orario di Roma? Pare che sia così.

Model TimeZoneList, lo tengo anche se scopro che è incorporato in php  
[https://www.php.net/manual/en/datetimezone.listidentifiers.php](https://www.php.net/manual/en/datetimezone.listidentifiers.php)

Se voglio registrare un datetime sarà `2025-09-19T11:38:45`,  
Se voglio registrare un datetime con timezone sarà `2025-09-19T11:38:45+02:00`,  
solo 6 byte in più come stringa. Poi però devo convertire questo numero in un
orario leggibile e in un campo editabile senza difficoltà. La timezone può essere
un dato immutabile dell'utente, oppure va messo nella scheda del concorso?
Per ora ho scelto la seconda opzione, quindi il mio campo nel modulo
sarà `2025-09-19T11:38:45`, il campo timezone sarà `Europe/Rome`,
e devo arrivare a `2025-09-19T11:38:45+02:00`.

### DateTimeZone from php 8.4

[https://www.php.net/manual/it/class.datetimezone.php](https://www.php.net/manual/it/class.datetimezone.php)  
Consente di avere la lista dei timezone senza memorizzarla in array,
ma di fatto il Model [TimezoneList](/app/Models/TimezonesList.php)
serve lo stesso perché contiene il validator is_

## Stop studiare, fare

* Utente entra in piattaforma
* dalla dashboard / [Quadro comandi](/resources/views/dashboard.blade.php) si deve vedere che
  Mario Rossi fa parte di organizzazione (User Roles)
* dalla dashboard deve esserci un link per dichiarare che si fa parte di una organizzazione e aggiungere l'organizzazione
* per effetto di user roles può andare nel pannello di organizzazione

Pannello *I'm member of* con select della lista di organizzazioni,
una volta scelta una organizzazione parte l'update della tabella
*user_roles* dove allo user_id viene associato l'organization_id con qualifica 'member of'.

Sopra al pannello un link "Add new Organization",

Sotto al pannello una lista con i record già presenti in
*user_roles*, in cui si può cambiare la qualifica da *member of*
in *president*, per adesso.

Quando funziona tutto si replica per le federazioni.

* [ ] Fare spazio ordinando alcuni link in griglia  
Al momento gli elementi sono piazzati come traverse in mappa,
con distanziamento eccessivo, ma non c'è un chiaro sistema di
griglia, che in laravel sembra sia dedicata alle schede
prodotto da proporre dinamicamente prelevandole da una tabella e Model.
* [ ] lista delle organizzazioni di cui lo user è member of  
Serve realizzare la tabella user_roles NO c'è già. Cancello i record di
[migration](/database/migrations/2025_09_19_170924_create_user_roles_table.php),
elimino la tabella e la ricreo da zero, con i ForeignUuid() e anche nullable(). Una delle regole di validation sarà che ci sia almeno uno dei tre tra organization.it, contest.id e federation.id
Serve realizzare il [Model](/app/Models/UserRole.php) Sì, manca. Fatto.
Serve realizzare factory e seeder: no. Servirebbe una serie di dati già coerenti con le tabelle di organizations contests e federations.

Create un paio di funzioni nel Model per usarle poi nel validate senza creare una Validation che non ho capito come
va creata e come va usata, se per validare un form o un model.
Avere degli esempi aiuterebbe.
