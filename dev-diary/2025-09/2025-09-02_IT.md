# Diario dello sviluppatore, data 2 settembre 2025

Nav: [index](../index.md) : [TDL](../TDL.md) : [log](../../storage/logs/laravel.log)

## Upload passport photo

La pagina modify funziona per tutti i campi escluso quello dell'immagine, oggi modifiche al controller e al blade
per aggiungere un upload file

*Per questioni di sicurezza non sono ammessi svg*?, probabilmente
svg essendo testo interpretato apre il fianco a trucchi che
non conosco ancora.

1. ‚úÖ Dire a laravel che deve gestire uno spazio disco
1. ‚úÖ Modificare il form per aggiungere il caricamento immagine
1. ‚úÖ Modificare il controller per validare l'immagine
1. ‚úÖ Modificare il controller per posizionare l'immagine nel disco
1. ‚úÖ Modificare il controller per visualizzare l'immagine al fianco del campo

ref. [Laravel File Storage](https://laravel.com/docs/12.x/filesystem)

* Si possono definire n dischi
  Questo comporta che per esempio posso tenere separati i work
  dai passport_photo, o anche tenerli insieme perch√©
  ci sar√† a far da chiave il valore dell'uuid assegnato
* esiste un riferimento `Storage::disk('local')`,
  e un disco public che va collegato, se sta su un server
  locale o se sta in un server remoto
* prima di usare, configurare. Si possono configurare abbonamenti al sistema amazon S3 ([*Amazon Simple Storage Service*](https://aws.amazon.com/it/s3/) adottato anche da altri come Aruba), o con il protocollo FTP *(meglio sftp, se si pu√≤)* o con il protocollo SFTP (richiede certificati di accesso).
* si possono configurare dei filesystem che in automatico aggiungono un prefisso, e quindi sono dedicati *Scoped* e si possono definire anche filesystem a sola lettura, tipo cd-rom üìÄ.

TODO: Aggiungere il titolo Mr. Mrs. other gender

### Dire a Laravel che deve mettere via file

In `storage/app/public` che deve essere accessibile da un link simbolico in `public/storage`

```php
$ php artisan storage:link

  INFO  The [public/storage] link has been connected to [storage/app/public].  
```

Creazione del link in `config/filesystem.php` per ora lascio com'√®

```php
    'links' => [
        public_path('storage') => storage_path('app/public'),
    ],
```

Adesso si va a cambiare `update()`, mmm no troppo diverso da quello che devo fare.
in questo tutorial non c'√® livewire ma React, usa il `method="POST"` e nel controller
che riceve i dati c'√® input `Request $request`, insomma un'altra parrocchia.

[Altro tutorial](https://www.youtube.com/watch?v=j2W06d-aVv0&list=PL6tf8fRbavl0Trc4Y9uxTXfcdATsv0PBs&index=2)
Importante distinguere il dato in tabella NON √à l'immagine.
Quindi nel modulo il campo dell'immagine dev'essere diverso dalla colonna passport_photo.
*Nota: non usare il metodo upload()*, **upload** √® riservato a livewire.

Ok, ottimo. **Nessun errore e ...fatto niente**. Che `$this` arriva dal form? $passport_photo_image vuoto

Pensato di girare tutto come un calzino, sostanzialmente s√¨, funziona ma serve
salvare in passport_photo un path e nome file, e se nel nome file ci sono spazi?
(senza *se*, prima o poi ci sono, o anche peggio)

urlencode() urldecode()? str_ireplace()? Se lo faccio in store devo farlo in pick.
Il campo della tabella si aggiorna, ma il file no.

E invece...  
funzione: storeAs( path, name) memorizza nella /private.  
funzione: storePubliclyAs( path, name) memorizza nella /public.  

La luce!

`<img src="{{ asset('assets/upload/imgdogs') . '/' . $row->dogpic }}" alt="" class="image">`

```php
$ php artisan livewire:publish --config

   INFO  Publishing [livewire:config] assets.  

  Copying file [vendor/livewire/livewire/config/livewire.php] to [config/livewire.php] ........................................................ DONE
```
