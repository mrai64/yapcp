# Diario dello sviluppatore, data 1 gennaio 2026

* [index](../index.md) |
  [project](https://github.com/users/mrai64/projects/1/views/1?filterQuery=is%3Aopen&sortedBy%5Bdirection%5D=asc&sortedBy%5BcolumnId%5D=Title) issue list |
  [To Do List](../TDL.md) svuotato  

* [Route](/routes/web.php)

* [◀️ Diario di ieri](../2025-12/2025-12-31_IT.md)

* run <http://yapcp.test/>
* User Doc <http://yapcp.test/docs/1.0/> [index](/resources/docs/1.0/index.md)
* [log](/storage/logs/laravel-2026-01-01.log) | ngnix log  `open ~/Library/Application\ Support/Herd/Log`

## Today Do list

* User Contact Modify, la parte per le federazioni

## UserContact Modify / 5 Federation Additional fields

Sono ancora a litigare con i comportamenti bizzarri del modulo,
per esempio compare tutto regolarmente ma appena scrivo qualcosa nei campi
scompare il campo, non il valore, ma tutto il modulo.

Altra cosa: tabella normalizzata. la tabella delle definizioni dei campi
FederationAdditionalFieldName s dovrebbe chiamare AdditionalFedFieldDefinitions
e la tabella degli AdditionalFields di fatto è una tabella
pivot tra la tabella user_contacts e la tabella additional_federation_field_definitions,
contenendo "la sua" pk e due fk. Tutto qui.

Recupero la domanda originaria fatta lo scorso 30 dicembre a GEmini, la seconda.
E nel frattempo scopro ma lo sospettavo gà, che tute le richieste
fatte vengono memorizzate e sono a disposizione di Gemini per 18 mesi
per analisi ad parte di umani.

Ripasso quanto scritto per allineare il modulo.  
Devo evitare di usare termini che possono andare in conflitto
con le librerie di laravel e nomi italiani.
[Gemini say 2 del 30 dicembre](../2025-12/2025-12-30_gemini_say_2.md)

[Richiesta da zero a Gemini](./2026-01-01_gemini_say_1.md)

Seguo le indicazioni e più o meno cambio dei nomi ma solo quelli,
sembra tutto giusto. Dal Component passo al blade.  
Niente da fare, il problema persiste.  
Riparto dal foglio bianco. Sistemo web.php e rinomino blade e component
per non buttarli nel cestino, rigenero blade e component e ripristino web.php

Foglio bianco, inizio a seguire il consiglio di gemini alla lettera. Finché posso,
perché i dati li devo tirare fuori sia dalle definizioni che dai valori.
E alla fine niente, ancora lo stesso scherzo.

Mi è anche venuto in mente che in precedenza avevo avuto dei
problemi con dei valori underscore  che avevo sostituito
con dei valori camelCase, e sai mai, provo anche questa
che non crei casino il '_', nisba.

Foglio bianco punto a capo.
Cestino le tabelle, cestino ail modulo 5 e riparto

----

## Campi aggiuntivi

Oltre ai campi "base" degli user_contacts, ai fogli excel della reportistica
alle varie federazioni vanno aggiunti dei campi che riguardano solo
le federazioni sponsor dei concorsi.

Questi campi aggiuntivi devono stare in una tabella KV che
è legata alla tabella user_contacts da una relazione 1:N

La tabella KV deve però seguire uno standard predefinito
che prevede la definizione per ogni federazione dei campi richiesti,
nella forma: id federazione, nome del campo, tipo del campo (per ora tutti text),
etichetta del campo. A questi si può aggiungere un dato ulteriore
che andrà a costituire la regola di validazione del dato.

Ad esempio ogni federazione ha un suo id_card o card_id,
e il formato può essere un progressivo numerico, oppure un
numerico che inizia con l'anno di tesseramento, oppure
può contenere un codice nazione, ogni federazione può disporre
di una propria regola indipendente.

Altro esempio la federazione FIAF richiede, oltre al suo numero tessera card_id,
anche un dato chiamato codice fiscale, italian_tax_id, per le persone.
Questo ad aiutare a risolvere gli omonimi.

Nomi delle tabelle **migliori di prima**

* **user_contact_mores**  
per i dati che saranno aggiunti agli utenti
* **federation_mores**  
Non una tabella lookup basata su una sola chiave ma su due, la federation_id e la chiave
del valore. CREATA

Caricati MANUALMENTE i due valori per la federazione FIAF, con italian_tax_id.

NON creo la tabella user_contact_mores come tabella pivot,
gli metto come alla precedente il campo user_id, e i campi federation_id
e field_name. In alternativa dovrebbe essere  
- id tabella  
- user_contacts.id  
- federation_mores.id  
- value

Chi la dura la vince, adesso pare che tutto funzioni senza scherzi di prestigio
e con i valori che arrivano fino in fondo.  
C'è un nuovo però: dovrebbero essere valori facoltativi, non lo sono.
Se uno non è iscritto il numero di tessera che è preimpostato
'000000' dovrebbe passare i controlli ma non li passa, se invece
è diverso da 000000 dovrebbe andare a controlli.

