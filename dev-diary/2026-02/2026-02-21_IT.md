# 21/02/2026

[⏪ ieri](./2026-02-20_IT.md) | [index](../index.md) | [domani ⏩](./2026-02-22_IT.md)  
[Docs](/resources/docs/1.0/overview.md)

## Continua la revisione di user_contacts.id [ricerca](./2026-02-13_user_id.code-search)

Siamo ai Models che richiamano abbondantemente `UserContact::class` con user_id prossimamente solo id  
Al termine del giro, che termina con gli app/Models, parto a rigenerare il mondo
e fare la check list delle cose da ripetere e da testare.

### User Works

Nella tabella devo indicare se il file è
dichiarato monocromatico, una colonna raw
mi dichiara che sono disponibile come richiesto
dalla federazione per la sezione tema
a fornire le copie originali richieste.

## Terminata la revisione di user_contacts.id

Sarebbe potuta essere più rapida se non mi fossi fermato a cambiare
spesso i sorgenti secondo le [regole PSR-12](https://www.php-fig.org/psr/psr-12/),
che comunque non sono sempre applicabili perché i valori
dei dati "diretti" alle tabelle di database seguono
lo standard snake_case mentre le variabili il camelCase
e le classi il PascalCase. La colonna user_id, la variabile
userId, la classe User.

Ci saranno sicuramente errori rimasti per strata anche se
sono convinto del contrario, *il software è bacato fino a test positivo*.

Inoltre il test PHPStan è per ora limitato al livello 1.
C'è già troppa roba da verificare per il funzionamento
e alla fine anche un lancio di PhpStan ha tirato fuori
una ventina di errori da sistemare.

Ah, ho introdotto UserWork ma non ho eliminato Work, anche questo. Prima delle prove devo ripulire Work e WorkValidation
che sono sostituite da UserWork e UserWorkValidation.

E devo chiarirmi la condizione degli accessi,
non dev'essere che *tutti possono tutto*.
[Chiedi a Gemini](./2026-02-21-gemini-say-1.md)

Adesso sarebbe il momento per scassare e rifare tutto,
però devo preparare il dopo.

* Rules/ContestSectionRule sistemata
* Models/UserRole sistemata
* Models/UserContact sistemata
* Models/ContestWork sistemata
* Models/contestWaiting sistemata
* Models/ContestVote sistemata
* Models/ContestAward sistemata
* Livewire/Organization/preJury/WorkReviews 

### Verifica relazioni

```php
Class User
...
$postOne = $this->hasOne( // User 1 >> 1 Post
  Post::class, // posts         ext class
  'user_id', //   posts.user_id ext foreignKey
  'id' //         users.id      int idx/pk
);

$postSet = $this->hasMany( // User 1 >> N Post
  Post::class, // posts         ext class
  'user_id', //   posts.user_id ext foreignKey
  'id' //         users.id      int idx/pk
);

Class Post
...
$userAuthor = $this-belongsTo( Post 1 >> 1 User
  User::class, //   users         ext class
  'user_id', //     posts.user_id int foreignKey
  'id' //           users.id      ext int/pk
);
```


## Verifiche sui Models

1. Rigenerare migration (a perdere) factory seeder
1. verificare se nella migration la pk è uuid che nel model sua presente hasUuids
1. verificare i getters, se sono stati usati o sono teorici
1. verificare le relation hasOne hasMany belongsTo la foreignKey
  dev'essere user_contact_id al posto di user_id
  per dare a eloquence il nome della tabella user_contacts
1. Verificare una alla volta tutte le azioni che è
previsto fare all'interno della piattaforma: iscriversi,
aggiungere organization, aggiungere concorsi, aggiungere giurati,
gestire concorsi, ricevere rapporti.

Elenco Models

1. Model Country
1. Model Region
1. Model Timezone
1. Model Federation
1. Model FederationMore
1. Model FederationSection
1. Model User
1. Model UserContact
1. Model UserRolesRoleSet

## Un'altra To Do List

* Step 1. rigenerare il database
  * migrate fresh
  * verifica che i legami ci siano
  * sistemazione delle migration e loop step 1.
* Step 2. Caricare le tabelle lookup
  * verificare che vengano caricate senza errori
    * countries
    * regions
    * timezones
    * federations
    * federation_sections
    * federation_mores
    * user_roles_role_sets
* Step 3. Generare users
  * Verificare che non siano generati in automatico
  i gemelli user_contacts (era il comportamento
  dei trigger sql)
  * generare e caricare anche user_contacts
  * caricare una ventina di fotografie per
    ciascun user_contact
* Step 4. Creare Organizations
  * Aggiungere members a organization
* Step 5. Creare Contest
  * definire concorsi senza alcun patrocinio
  * definire concorsi con un patrocinio
  * definire concorsi con due patrocini
  * aggiungere concorrenti e immagini ai concorsi
* Step 6. Creare giurati
