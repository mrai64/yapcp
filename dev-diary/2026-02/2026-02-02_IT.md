# 02/02/2026

[index](../index.md) | [ieri](./2026-02-01_IT.md)  
[Docs](/resources/docs/1.0/overview.md)

## phpdoc: @property

Sulla scorta di un video da youtube
[Raccomandazioni Laravel](https://youtu.be/QFh21mFLH8I?si=2fkBVtXzafRngzZz)
decido di adottare le `@property` nella testata dei modelli.

Quando ci saranno aggiornamenti al database e quindi ai Model
servirà rilanciare lo script usando

```sh
php artisan ide-helper:models --write
```

Che usa l package Laravel Ide Helper

```sh
composer require --dev barryvdh/laravel-ide-helper
```

## Scoperto HasUuid

Come ci sono le indicazioni use HasFactory / use SoftDelete, esiste anche
la use HasUUid, che "si occupa" di fare la creazione di un
id stringa non incrementale, che contiene un uuid versione 7.
Questa versione della definizione di campo uuid occupa sempre 36 caratteri
utf8mb4, ma non è più necessario definire id stringa, non incrementabile ed
è una comodità adesso che le ho allineate su tutti i modelli andare
a toglierle su tutti i modelli che li usano,
non solo: si possono compattare in 36 caratteri 36. Con la codifica ASCII.

## La mia collection di farfalle

Questione efficienza: la collection utf8mb4 va bene
per memorizzare stringhe, comprese le bandiere definite in unicode
per tutti i paesi del mondo e qualcosa in più (bandiera bianca,
nazioni unite ecc.) ma per memorizzare indici con le chiavi uuid
conviene passarle alla collection ASCII. Occuperanno SOLO 36 byte al posto
di 144byte perché utf8mb4 usa 4byte per ogni char, 36 che potrebbero
diventare anche 32 se si levano i trattini.

Usare uuid v7 consente di legare il codice al timestamp
consentendo di ordinarli in sequenza cronologica pur mantenendo
la loro caratteristica di unicità.

Volendo invece usare il "vecchio" uuid versione 4 si avranno
codici veramente causali e che si distribuiscono qua e la.

---

Cose da fare:

Per mettere la collation ASCII in mysql devo prima smontare le relazioni
a livello di mysql, poi fare il cambio di formato, poi fare la ricostruzione
delle relazioni.

1. Contest
    1. Va smontata la relazione con countries.id
    1. Va smontata la relazione con la tabella timezones
    1. Va convertita la colonna id in ASCII
    1. Va convertita la colonna country_id in ASCII
    1. Va convertita la colonna timezones_id in ASCII
    1. Va rimessa la relazione con la tabella countries
    1. Va rimessa la relazione con la tabella timezones

1. ContestAward
    1. va smontata la relazione con contests.id
    1. va smontata la relazione con contest_sections.id (se c'è)
    1. va modificata la colonna id in ASCII
    1. va modificata la colonna contest_id in ASCII
    1. va modificata la colonna section_id in ASCII
    1. va rimessa la relazione con contests.id
    1. va rimessa la relazione con contest_sections.id (aggiungere)
1. ContestJury
    1. va smontata la relazione con contest_section_id
    1. va smontata la relazione con user_contacts.user_id
    1. va modificata la colonna id in ASCII
    1. va modificata la colonna section_id in ASCII
    1. va modificata la colonna user_contact_id in ASCII
    1. va rimessa la relazione con user_contacts.user_id
    1. va rimessa la relazione con contest_sections.id
1. ContestParticipant
    1. va smontata la relazione con contests.id
    1. va smontata la relazione con user_contacts.user_id
    1. va modificata la colonna id in ASCII
    1. va modificata la colonna contest_id in ASCII
    1. va modificata la colonna user_id in ASCII
    1. va rimessa la relazione con contests.id
1. ContestSection
    1. va smontata la relazione con contests.id
    1. va modificata la colonna id in ASCII
    1. va modificata la colonna contest_id in ASCII
    1. va rimessa la relazione con contests.id
1. ContestsVoteRuleSet  
Non c'è niente da fare
1. ContestVote
    1. va smontata la relazione con contests.id
    1. va smontata la relazione con contest_sections.id
    1. va smontata la relazione con works.id
    1. va smontata la relazione con user_contacts.id
    1. va modificata la colonna id in ASCII
    1. va modificata la colonna juror_user_id ASCII
    1. va modificata la colonna work_id ASCII
    1. va modificata la colonna section_id ASCII
    1. va modificata la colonna contest_id ASCII
    1. va rimessa la relazione con contests.id
    1. va rimessa la relazione con contest_sections.id
    1. va rimessa la relazione con works.id
    1. va rimessa la relazione con user_contacts.id
1. ContestWaiting
    1. va smontata la relazione con contests.id
    1. va smontata la relazione con contest_sections.id
    1. va smontata la relazione con works.id
    1. va smontata la relazione con user_contacts.user_id partecipante
    1. va smontata la relazione con user_contacts.user_id giurato
    1. va modificata la colonna id
    1. va modificata la colonna contest_id
    1. va modificata la colonna section_id
    1. va modificata la colonna work_id
    1. va modificata la colonna participant_user_id
    1. va modificata la colonna organization_user_id
    1. va rifatta la relazione con contests.id
    1. va rifatta la relazione con contest_sections.id
    1. va rifatta la relazione con works.id
    1. va rifatta la relazione con user_contacts.user_id partecipante
    1. va rifatta la relazione con user_contacts.user_id giurato
1. ContestWork
    1. va smontata la relazione con contests.id
    1. va smontata la relazione con contest_sections.id
    1. va smontata la relazione con countries.id
    1. va smontata la relazione con user_contacts.user_id
    1. va smontata la relazione con works.id
    1. va modificata la colonna id
    1. va modificata la colonna contest_id
    1. va modificata la colonna section_id
    1. va modificata la colonna country_id
    1. va modificata la colonna user_id
    1. va modificata la colonna work_id
    1. va rifatta la relazione con contests.id
    1. va rifatta la relazione con contest_sections.id
    1. va rifatta la relazione con countries.id
    1. va rifatta la relazione con user_contacts.user_id
    1. va rifatta la relazione con works.id

1. Country
    1. va modificata la colonna id

1. Federation
1. FederationMore
1. FederationSection
1. LangList
1. Organization
1. Region
1. Timezone
1. TimezonesList
1. User
1. UserContact
1. UserContactMore
1. UserRole
1. UserRolesRoleSet
1. Work
1. WorkValidation

[Chiedi a Gemini](2026-02-02-geminy-say-1.md)

Alla fine **viva la scorciatoia**, metto in mezzo Sequel Ace e
faccio il cambio in applicazione. Perché a bloccare
l'operazione sono i legami del campo con le tabelle
anche se sono definiti nelle tabelle fuori.

Cambiare tutti gli uuid in ascii/ascii_general_ci

## *.user_id che è user_contact.user_id

Ci sarebbe da cambiare un paio di cose no da poco:

1. Cambiare user_contacts.user_id nella primary key
della tabella user_contacts
1. Togliere user_contacts.id e rinominare user_contacts.user_id
come user_contacts.id
1. Cambiare tutti i rifermenti a users.id in user_contacts.id
in giro per la piattaforma.

Robetta da niente...
